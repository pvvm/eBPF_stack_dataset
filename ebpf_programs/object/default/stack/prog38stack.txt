
ebpf_programs/object/default/prog38.bpf.o:	file format elf64-bpf

Disassembly of section xdp:

0000000000000000 <xdp_prog>:
; int xdp_prog(struct xdp_md *ctx) {
       0:	7b 1a a0 ff 00 00 00 00	*(u64 *)(r10 - 96) = r1
;     void *data_end = (void *)(long)ctx->data_end;
       1:	79 a1 a0 ff 00 00 00 00	r1 = *(u64 *)(r10 - 96)
       2:	61 11 04 00 00 00 00 00	r1 = *(u32 *)(r1 + 4)
       3:	7b 1a 98 ff 00 00 00 00	*(u64 *)(r10 - 104) = r1
; 	void *data = (void *)(long)ctx->data;
       4:	79 a1 a0 ff 00 00 00 00	r1 = *(u64 *)(r10 - 96)
       5:	61 11 00 00 00 00 00 00	r1 = *(u32 *)(r1 + 0)
       6:	7b 1a 90 ff 00 00 00 00	*(u64 *)(r10 - 112) = r1
; 	nh.pos = data;
       7:	79 a1 90 ff 00 00 00 00	r1 = *(u64 *)(r10 - 112)
       8:	7b 1a 80 ff 00 00 00 00	*(u64 *)(r10 - 128) = r1
; 	nh_type = parse_ethhdr(&nh, data_end, &eth);
       9:	79 a1 98 ff 00 00 00 00	r1 = *(u64 *)(r10 - 104)
      10:	bf a2 00 00 00 00 00 00	r2 = r10
;     void *data_end = (void *)(long)ctx->data_end;
      11:	07 02 00 00 80 ff ff ff	r2 += -128
      12:	7b 2a c8 ff 00 00 00 00	*(u64 *)(r10 - 56) = r2
      13:	7b 1a c0 ff 00 00 00 00	*(u64 *)(r10 - 64) = r1
      14:	bf a1 00 00 00 00 00 00	r1 = r10
      15:	07 01 00 00 88 ff ff ff	r1 += -120
      16:	7b 1a b8 ff 00 00 00 00	*(u64 *)(r10 - 72) = r1
; struct ethhdr *eth = nh->pos;
      17:	79 a1 c8 ff 00 00 00 00	r1 = *(u64 *)(r10 - 56)
      18:	79 11 00 00 00 00 00 00	r1 = *(u64 *)(r1 + 0)
      19:	7b 1a b0 ff 00 00 00 00	*(u64 *)(r10 - 80) = r1
      20:	b7 01 00 00 0e 00 00 00	r1 = 14
; int hdrsize = sizeof(*eth);
      21:	63 1a ac ff 00 00 00 00	*(u32 *)(r10 - 84) = r1
; if (nh->pos + 1 > data_end)
      22:	79 a1 c8 ff 00 00 00 00	r1 = *(u64 *)(r10 - 56)
      23:	79 12 00 00 00 00 00 00	r2 = *(u64 *)(r1 + 0)
      24:	07 02 00 00 01 00 00 00	r2 += 1
      25:	79 a1 c0 ff 00 00 00 00	r1 = *(u64 *)(r10 - 64)
      26:	3d 21 05 00 00 00 00 00	if r1 >= r2 goto +5 <LBB0_2>
      27:	05 00 00 00 00 00 00 00	goto +0 <LBB0_1>

00000000000000e0 <LBB0_1>:
      28:	18 01 00 00 ff ff ff ff 00 00 00 00 00 00 00 00	r1 = 4294967295 ll
; return -1;
      30:	63 1a d4 ff 00 00 00 00	*(u32 *)(r10 - 44) = r1
      31:	05 00 11 00 00 00 00 00	goto +17 <LBB0_3>

0000000000000100 <LBB0_2>:
; nh->pos += hdrsize;
      32:	61 a3 ac ff 00 00 00 00	r3 = *(u32 *)(r10 - 84)
      33:	67 03 00 00 20 00 00 00	r3 <<= 32
      34:	c7 03 00 00 20 00 00 00	r3 s>>= 32
      35:	79 a2 c8 ff 00 00 00 00	r2 = *(u64 *)(r10 - 56)
      36:	79 21 00 00 00 00 00 00	r1 = *(u64 *)(r2 + 0)
      37:	0f 31 00 00 00 00 00 00	r1 += r3
      38:	7b 12 00 00 00 00 00 00	*(u64 *)(r2 + 0) = r1
; *ethhdr = eth;
      39:	79 a1 b0 ff 00 00 00 00	r1 = *(u64 *)(r10 - 80)
      40:	79 a2 b8 ff 00 00 00 00	r2 = *(u64 *)(r10 - 72)
      41:	7b 12 00 00 00 00 00 00	*(u64 *)(r2 + 0) = r1
; return eth->h_proto;
      42:	79 a1 b0 ff 00 00 00 00	r1 = *(u64 *)(r10 - 80)
      43:	71 12 0c 00 00 00 00 00	r2 = *(u8 *)(r1 + 12)
      44:	71 11 0d 00 00 00 00 00	r1 = *(u8 *)(r1 + 13)
      45:	67 01 00 00 08 00 00 00	r1 <<= 8
      46:	4f 21 00 00 00 00 00 00	r1 |= r2
      47:	63 1a d4 ff 00 00 00 00	*(u32 *)(r10 - 44) = r1
      48:	05 00 00 00 00 00 00 00	goto +0 <LBB0_3>

0000000000000188 <LBB0_3>:
; }
      49:	61 a1 d4 ff 00 00 00 00	r1 = *(u32 *)(r10 - 44)
; 	nh_type = parse_ethhdr(&nh, data_end, &eth);
      50:	63 1a 7c ff 00 00 00 00	*(u32 *)(r10 - 132) = r1
; 	if (nh_type != bpf_htons(ETH_P_IPV6))
      51:	61 a1 7c ff 00 00 00 00	r1 = *(u32 *)(r10 - 132)
      52:	15 01 04 00 86 dd 00 00	if r1 == 56710 goto +4 <LBB0_5>
      53:	05 00 00 00 00 00 00 00	goto +0 <LBB0_4>

00000000000001b0 <LBB0_4>:
      54:	b7 01 00 00 01 00 00 00	r1 = 1
;         return XDP_DROP;
      55:	63 1a a8 ff 00 00 00 00	*(u32 *)(r10 - 88) = r1
      56:	05 00 2a 00 00 00 00 00	goto +42 <LBB0_11>

00000000000001c8 <LBB0_5>:
; 	nh_type = parse_ip6hdr(&nh, data_end, &ip6h);
      57:	79 a1 98 ff 00 00 00 00	r1 = *(u64 *)(r10 - 104)
      58:	bf a2 00 00 00 00 00 00	r2 = r10
      59:	07 02 00 00 80 ff ff ff	r2 += -128
      60:	7b 2a f0 ff 00 00 00 00	*(u64 *)(r10 - 16) = r2
      61:	7b 1a e8 ff 00 00 00 00	*(u64 *)(r10 - 24) = r1
      62:	bf a1 00 00 00 00 00 00	r1 = r10
      63:	07 01 00 00 70 ff ff ff	r1 += -144
      64:	7b 1a e0 ff 00 00 00 00	*(u64 *)(r10 - 32) = r1
; struct ipv6hdr *ip6h = nh->pos;
      65:	79 a1 f0 ff 00 00 00 00	r1 = *(u64 *)(r10 - 16)
      66:	79 11 00 00 00 00 00 00	r1 = *(u64 *)(r1 + 0)
      67:	7b 1a d8 ff 00 00 00 00	*(u64 *)(r10 - 40) = r1
; if (ip6h + 1 > data_end)
      68:	79 a2 d8 ff 00 00 00 00	r2 = *(u64 *)(r10 - 40)
      69:	07 02 00 00 28 00 00 00	r2 += 40
      70:	79 a1 e8 ff 00 00 00 00	r1 = *(u64 *)(r10 - 24)
      71:	3d 21 05 00 00 00 00 00	if r1 >= r2 goto +5 <LBB0_7>
      72:	05 00 00 00 00 00 00 00	goto +0 <LBB0_6>

0000000000000248 <LBB0_6>:
      73:	18 01 00 00 ff ff ff ff 00 00 00 00 00 00 00 00	r1 = 4294967295 ll
; return -1;
      75:	63 1a fc ff 00 00 00 00	*(u32 *)(r10 - 4) = r1
      76:	05 00 0b 00 00 00 00 00	goto +11 <LBB0_8>

0000000000000268 <LBB0_7>:
; nh->pos = ip6h + 1;
      77:	79 a1 d8 ff 00 00 00 00	r1 = *(u64 *)(r10 - 40)
      78:	07 01 00 00 28 00 00 00	r1 += 40
      79:	79 a2 f0 ff 00 00 00 00	r2 = *(u64 *)(r10 - 16)
      80:	7b 12 00 00 00 00 00 00	*(u64 *)(r2 + 0) = r1
; *ip6hdr = ip6h;
      81:	79 a1 d8 ff 00 00 00 00	r1 = *(u64 *)(r10 - 40)
      82:	79 a2 e0 ff 00 00 00 00	r2 = *(u64 *)(r10 - 32)
      83:	7b 12 00 00 00 00 00 00	*(u64 *)(r2 + 0) = r1
; return ip6h->nexthdr;
      84:	79 a1 d8 ff 00 00 00 00	r1 = *(u64 *)(r10 - 40)
      85:	71 11 06 00 00 00 00 00	r1 = *(u8 *)(r1 + 6)
      86:	63 1a fc ff 00 00 00 00	*(u32 *)(r10 - 4) = r1
      87:	05 00 00 00 00 00 00 00	goto +0 <LBB0_8>

00000000000002c0 <LBB0_8>:
; }
      88:	61 a1 fc ff 00 00 00 00	r1 = *(u32 *)(r10 - 4)
; 	nh_type = parse_ip6hdr(&nh, data_end, &ip6h);
      89:	63 1a 7c ff 00 00 00 00	*(u32 *)(r10 - 132) = r1
; 	if (nh_type != IPPROTO_ICMPV6)
      90:	61 a1 7c ff 00 00 00 00	r1 = *(u32 *)(r10 - 132)
      91:	15 01 04 00 3a 00 00 00	if r1 == 58 goto +4 <LBB0_10>
      92:	05 00 00 00 00 00 00 00	goto +0 <LBB0_9>

00000000000002e8 <LBB0_9>:
      93:	b7 01 00 00 01 00 00 00	r1 = 1
; 		return XDP_DROP;
      94:	63 1a a8 ff 00 00 00 00	*(u32 *)(r10 - 88) = r1
      95:	05 00 03 00 00 00 00 00	goto +3 <LBB0_11>

0000000000000300 <LBB0_10>:
      96:	b7 01 00 00 01 00 00 00	r1 = 1
;     return XDP_DROP; // Drop all packets
      97:	63 1a a8 ff 00 00 00 00	*(u32 *)(r10 - 88) = r1
      98:	05 00 00 00 00 00 00 00	goto +0 <LBB0_11>

0000000000000318 <LBB0_11>:
; }
      99:	61 a0 a8 ff 00 00 00 00	r0 = *(u32 *)(r10 - 88)
     100:	95 00 00 00 00 00 00 00	exit
